{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"super-miner \u5bb6\u7528\u6316\u77ff\u3001\u81ea\u5efa\u673a\u623f\u3001IDC\u673a\u623f\u7b49\u573a\u666f\u7684\u4e00\u4e2a\u53ef\u7ec4\u5408\u6316\u77ff\u673a\u5668\u7ba1\u7406\u65b9\u6848 \u5305\u542b\u7ec4\u4ef6: \u672c\u76d1\u63a7\u65b9\u6848\u662f\u57fa\u4e8e\u4e0b\u9762\u4f18\u79c0\u7684\u5f00\u6e90\u9879\u76ee\u800c\u6210: ansible :\u81ea\u52a8\u5316\u8fd0\u7ef4 alertmanager :Prometheus Alertmanager frp : \u53cd\u5411\u4ee3\u7406 grafana : \u6570\u636e\u53ef\u89c6\u5316\u5e73\u53f0 prometheus : \u76d1\u6d4b\u7cfb\u7edf\u548c\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u5e93 consul : \u52a8\u6001\u914d\u7f6e registrator : \u670d\u52a1\u6ce8\u518c node exporter : \u673a\u5668\u76d1\u63a7\u4fe1\u606f cadvisor : \u8d44\u6e90\u5bb9\u5668\u4fe1\u606f jumpserver : \u5821\u5792\u673a promtail : \u65e5\u5fd7\u6536\u96c6\u5668 loki : \u65e5\u5fd7\u805a\u5408\u5668 karma : Alert dashboard \u5de5\u5177 \u6ce2\u5361\u7cfb\u77ff\u5de5\u6279\u91cf\u8d26\u53f7\u5de5\u5177 \u6587\u6863 \u9879\u76ee\u6587\u6863\u63d0\u4f9b\u4e86\u90e8\u7f72\u6559\u7a0b\u548c\u5e38\u7528\u8fd0\u7ef4\u547d\u4ee4\uff0c\u5177\u4f53\u8bbf\u95ee super-miner\u6587\u6863 \u5efa\u8bae\u4e0e\u610f\u89c1 \u672c\u9879\u76ee\u5904\u4e8e\u7ef4\u62a4\u72b6\u6001\uff0c\u76ee\u7684\u662f\u63d0\u4f9b\u7269\u7406\u673a\u5668\u4e0b\u53ef\u7ec4\u5408\u7684\u77ff\u673a\u7ba1\u7406\u65b9\u6848\uff0c\u6b22\u8fce\u63d0\u51fa\u5404\u79cd\u5efa\u8bae\u6216\u8005\u610f\u89c1,\u6216\u8005\u9700\u8981\u65b0\u589e\u52a0\u7ec4\u4ef6\uff0c\u5177\u4f53\u65b9\u5f0f\u4ee5issue\u7684\u5f62\u5f0f\u8fdb\u884c. \u5bf9\u4e8e\u65b0\u7684\u65b9\u5411\u4e5f\u6b22\u8fce\u63d0\u51fa. \u4ea4\u6d41 \u4ea4\u6d41\u8be6\u60c5 \u6253\u8d4f \u5982\u679c\u8be5\u9879\u76ee\u5bf9\u4f60\u6709\u7528\uff0c\u4f60\u662f\u5426\u613f\u610f\u6253\u8d4f\u5462\uff1f BTC : 3PWeE9gcounVUxxGjA4JrWg4EDiTmjmpNU ETH : 0x1e42727934d14B180863346B108C612fD4a9eA99 DOT : 15Y7HvAvPyXWMxDsujMrneEXmFyqXURmBGi5BTWfcFgWAbV8 KSM : GErd9vicRMBg4ppzzgASLxoj5FiRYMituXevGupWDvKVey8 NEAR : bingryan.near \u5c55\u793a License \u672c\u9879\u76ee\u4e3a\u7ba1\u7406\u5b58\u653e\u5728\u5168\u7403\u591a\u4e2a\u5730\u65b9\u51e0\u5343\u53f0\u77ff\u673a\u7ba1\u7406\u7684\u65b9\u6848\u5b9e\u73b0,\u5168\u90e8\u57fa\u4e8e\u5f00\u6e90\u7ec4\u4ef6\u800c\u6210\uff0c\u65e0License\uff0c\u53ef\u4ee5\u968f\u4fbf\u590d\u5236\u4f7f\u7528\u548c\u7528\u4e8e\u4efb\u4f55\u5404\u79cd\u76ee\u7684\u3002\u540c\u65f6\u4e0d\u5bf9\u4f7f\u7528\u8fc7\u7a0b\u51fa\u73b0\u7684\u95ee\u9898\u8d1f\u4efb\u4f55\u8d23\u4efb.","title":"\u6587\u6863\u6982\u8981"},{"location":"#super-miner","text":"","title":"super-miner"},{"location":"#_1","text":"\u672c\u76d1\u63a7\u65b9\u6848\u662f\u57fa\u4e8e\u4e0b\u9762\u4f18\u79c0\u7684\u5f00\u6e90\u9879\u76ee\u800c\u6210: ansible :\u81ea\u52a8\u5316\u8fd0\u7ef4 alertmanager :Prometheus Alertmanager frp : \u53cd\u5411\u4ee3\u7406 grafana : \u6570\u636e\u53ef\u89c6\u5316\u5e73\u53f0 prometheus : \u76d1\u6d4b\u7cfb\u7edf\u548c\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u5e93 consul : \u52a8\u6001\u914d\u7f6e registrator : \u670d\u52a1\u6ce8\u518c node exporter : \u673a\u5668\u76d1\u63a7\u4fe1\u606f cadvisor : \u8d44\u6e90\u5bb9\u5668\u4fe1\u606f jumpserver : \u5821\u5792\u673a promtail : \u65e5\u5fd7\u6536\u96c6\u5668 loki : \u65e5\u5fd7\u805a\u5408\u5668 karma : Alert dashboard","title":"\u5305\u542b\u7ec4\u4ef6:"},{"location":"#_2","text":"\u6ce2\u5361\u7cfb\u77ff\u5de5\u6279\u91cf\u8d26\u53f7\u5de5\u5177","title":"\u5de5\u5177"},{"location":"#_3","text":"\u9879\u76ee\u6587\u6863\u63d0\u4f9b\u4e86\u90e8\u7f72\u6559\u7a0b\u548c\u5e38\u7528\u8fd0\u7ef4\u547d\u4ee4\uff0c\u5177\u4f53\u8bbf\u95ee super-miner\u6587\u6863","title":"\u6587\u6863"},{"location":"#_4","text":"\u672c\u9879\u76ee\u5904\u4e8e\u7ef4\u62a4\u72b6\u6001\uff0c\u76ee\u7684\u662f\u63d0\u4f9b\u7269\u7406\u673a\u5668\u4e0b\u53ef\u7ec4\u5408\u7684\u77ff\u673a\u7ba1\u7406\u65b9\u6848\uff0c\u6b22\u8fce\u63d0\u51fa\u5404\u79cd\u5efa\u8bae\u6216\u8005\u610f\u89c1,\u6216\u8005\u9700\u8981\u65b0\u589e\u52a0\u7ec4\u4ef6\uff0c\u5177\u4f53\u65b9\u5f0f\u4ee5issue\u7684\u5f62\u5f0f\u8fdb\u884c. \u5bf9\u4e8e\u65b0\u7684\u65b9\u5411\u4e5f\u6b22\u8fce\u63d0\u51fa.","title":"\u5efa\u8bae\u4e0e\u610f\u89c1"},{"location":"#_5","text":"\u4ea4\u6d41\u8be6\u60c5","title":"\u4ea4\u6d41"},{"location":"#_6","text":"\u5982\u679c\u8be5\u9879\u76ee\u5bf9\u4f60\u6709\u7528\uff0c\u4f60\u662f\u5426\u613f\u610f\u6253\u8d4f\u5462\uff1f BTC : 3PWeE9gcounVUxxGjA4JrWg4EDiTmjmpNU ETH : 0x1e42727934d14B180863346B108C612fD4a9eA99 DOT : 15Y7HvAvPyXWMxDsujMrneEXmFyqXURmBGi5BTWfcFgWAbV8 KSM : GErd9vicRMBg4ppzzgASLxoj5FiRYMituXevGupWDvKVey8 NEAR : bingryan.near","title":"\u6253\u8d4f"},{"location":"#_7","text":"","title":"\u5c55\u793a"},{"location":"#license","text":"\u672c\u9879\u76ee\u4e3a\u7ba1\u7406\u5b58\u653e\u5728\u5168\u7403\u591a\u4e2a\u5730\u65b9\u51e0\u5343\u53f0\u77ff\u673a\u7ba1\u7406\u7684\u65b9\u6848\u5b9e\u73b0,\u5168\u90e8\u57fa\u4e8e\u5f00\u6e90\u7ec4\u4ef6\u800c\u6210\uff0c\u65e0License\uff0c\u53ef\u4ee5\u968f\u4fbf\u590d\u5236\u4f7f\u7528\u548c\u7528\u4e8e\u4efb\u4f55\u5404\u79cd\u76ee\u7684\u3002\u540c\u65f6\u4e0d\u5bf9\u4f7f\u7528\u8fc7\u7a0b\u51fa\u73b0\u7684\u95ee\u9898\u8d1f\u4efb\u4f55\u8d23\u4efb.","title":"License"},{"location":"alert/","text":"\u9884\u8b66 TODO","title":"\u9884\u8b66"},{"location":"alert/#_1","text":"TODO","title":"\u9884\u8b66"},{"location":"deploy/","text":"\u9879\u76ee\u5b9e\u65bd\u6587\u6863 pull\u65b9\u5f0f\u90e8\u7f72 \u8be5\u90e8\u7f72\u65b9\u5f0f\u662f\u628a\u4e00\u4e2a\u62e5\u6709\u516c\u7f51IP\u7684\u4e91\u670d\u52a1\u5668\u4f5c\u4e3a\u6570\u636e\u6536\u96c6\u548c\u76d1\u63a7\u603b\u7ad9\uff0c\u5404\u4e2a\u673a\u5668\u7684\u6570\u636e\u4ee5\u4ee3\u7406\u7684\u65b9\u5f0f\uff0c\u901a\u8fc7 federate \u7684\u8fdb\u884c\u96c6\u4e2d\uff0c\u540c\u65f6\u6bcf\u4e2a\u673a\u5668\u7684\u4e2d\u7684\u6570\u636e\u4f1a\u96c6\u4e2d\u5230\u5f53\u5730\u673a\u5668\u7684master\uff0c\u7531master \u7edf\u4e00\u8f6c\u53d1\u5904\u7406 \u516c\u7f51\u4e3b\u673a\u914d\u7f6e \u4e91\u4e3b\u673a\u7ec4\u4ef6\u90e8\u7f72 \u4e0b\u8f7d\u6700\u65b0\u4ee3\u7801 git clone https://github.com/bingryan/super-miner.git && cd super-miner \u76f4\u63a5\u4ee5 docker-compose \u7684\u65b9\u5f0f\u76f4\u63a5\u542f\u52a8\u90e8\u7f72 sudo docker-compose up -d \u4e4b\u540e\u542f\u52a8\u4e91\u670d\u52a1\u5668\u7684\u76d1\u63a7 bash bin/starter.sh \u7136\u540e\u901a\u8fc7 nginx \u5df2\u7ecf\u4ee3\u7406\u7684\u57df\u540d\uff1a miner.your.domain \u8fdb\u884c\u8bbf\u95ee\u9875\u9762\uff0c\u4f60\u4f1a\u53d1\u73b0\u8be5\u670d\u52a1\u5668\u7684\u76d1\u63a7\u4fe1\u606f\u5df2\u7ecf\u5904\u4e8e\u76d1\u63a7 \u4e91\u4e3b\u673a\u4ee3\u7406server\u914d\u7f6e \u4e4b\u540e\u5728\u673a\u5668\u8fdb\u884c frp \u4ee3\u7406\u7684server\u7684\u542f\u52a8 docker run --restart=always --network host -d -v /etc/frp/frps.ini:/etc/frp/frps.ini --name frps snowdreamtech/frps \u673a\u623f\u673a\u5668 \u914d\u7f6efederate sudo docker-compose -f docker-compose.federate.yml up -d \u914d\u7f6e\u4ee3\u7406 docker run --restart=always --network host -d -v /etc/frp/frpc.ini:/etc/frp/frpc.ini --name frpc snowdreamtech/frpc \u6bcf\u53f0\u673a\u5668\u8981\u6267\u884c bin/starter.sh \u4e0b\u7684\u903b\u8f91\u3002\u91c7\u7528ansible \u8fdb\u884c\u6279\u91cf\u5904\u7406","title":"\u9879\u76ee\u5b9e\u65bd\u6587\u6863"},{"location":"deploy/#_1","text":"","title":"\u9879\u76ee\u5b9e\u65bd\u6587\u6863"},{"location":"deploy/#pull","text":"\u8be5\u90e8\u7f72\u65b9\u5f0f\u662f\u628a\u4e00\u4e2a\u62e5\u6709\u516c\u7f51IP\u7684\u4e91\u670d\u52a1\u5668\u4f5c\u4e3a\u6570\u636e\u6536\u96c6\u548c\u76d1\u63a7\u603b\u7ad9\uff0c\u5404\u4e2a\u673a\u5668\u7684\u6570\u636e\u4ee5\u4ee3\u7406\u7684\u65b9\u5f0f\uff0c\u901a\u8fc7 federate \u7684\u8fdb\u884c\u96c6\u4e2d\uff0c\u540c\u65f6\u6bcf\u4e2a\u673a\u5668\u7684\u4e2d\u7684\u6570\u636e\u4f1a\u96c6\u4e2d\u5230\u5f53\u5730\u673a\u5668\u7684master\uff0c\u7531master \u7edf\u4e00\u8f6c\u53d1\u5904\u7406","title":"pull\u65b9\u5f0f\u90e8\u7f72"},{"location":"deploy/#_2","text":"","title":"\u516c\u7f51\u4e3b\u673a\u914d\u7f6e"},{"location":"deploy/#_3","text":"\u4e0b\u8f7d\u6700\u65b0\u4ee3\u7801 git clone https://github.com/bingryan/super-miner.git && cd super-miner \u76f4\u63a5\u4ee5 docker-compose \u7684\u65b9\u5f0f\u76f4\u63a5\u542f\u52a8\u90e8\u7f72 sudo docker-compose up -d \u4e4b\u540e\u542f\u52a8\u4e91\u670d\u52a1\u5668\u7684\u76d1\u63a7 bash bin/starter.sh \u7136\u540e\u901a\u8fc7 nginx \u5df2\u7ecf\u4ee3\u7406\u7684\u57df\u540d\uff1a miner.your.domain \u8fdb\u884c\u8bbf\u95ee\u9875\u9762\uff0c\u4f60\u4f1a\u53d1\u73b0\u8be5\u670d\u52a1\u5668\u7684\u76d1\u63a7\u4fe1\u606f\u5df2\u7ecf\u5904\u4e8e\u76d1\u63a7","title":"\u4e91\u4e3b\u673a\u7ec4\u4ef6\u90e8\u7f72"},{"location":"deploy/#server","text":"\u4e4b\u540e\u5728\u673a\u5668\u8fdb\u884c frp \u4ee3\u7406\u7684server\u7684\u542f\u52a8 docker run --restart=always --network host -d -v /etc/frp/frps.ini:/etc/frp/frps.ini --name frps snowdreamtech/frps","title":"\u4e91\u4e3b\u673a\u4ee3\u7406server\u914d\u7f6e"},{"location":"deploy/#_4","text":"\u914d\u7f6efederate sudo docker-compose -f docker-compose.federate.yml up -d \u914d\u7f6e\u4ee3\u7406 docker run --restart=always --network host -d -v /etc/frp/frpc.ini:/etc/frp/frpc.ini --name frpc snowdreamtech/frpc \u6bcf\u53f0\u673a\u5668\u8981\u6267\u884c bin/starter.sh \u4e0b\u7684\u903b\u8f91\u3002\u91c7\u7528ansible \u8fdb\u884c\u6279\u91cf\u5904\u7406","title":"\u673a\u623f\u673a\u5668"},{"location":"disk/","text":"\u786c\u76d8 \u591a\u4e2a\u786c\u76d8\u5408\u5e76\u5b9e\u64cd 0.\u524d\u63d0\u4f9d\u8d56 sudo apt install lvm2 1.\u521b\u5efapv \u67e5\u770b\u6302\u8f7d\u786c\u76d8 lsblk sudo pvcreate /dev/sdb //\u786c\u76d81 sudo pvcreate /dev/sdc //\u786c\u76d82 sudo pvcreate /dev/sdd //\u786c\u76d83 sudo pvcreate /dev/sdf //\u786c\u76d84 sudo pvcreate /dev/sde //\u786c\u76d85 \u8bb0\u5f55\u5982\u4e0b\uff1a abc@abc:~$ pvcreate /dev/sdb WARNING: Running as a non-root user. Functionality may be unavailable. /run/lock/lvm/P_global:aux: open failed: Permission denied abc@abc:~$ sudo pvcreate /dev/sdb [ sudo ] password for abc: Physical volume \"/dev/sdb\" successfully created. abc@abc:~$ sudo pvcreate /dev/sdc WARNING: dos signature detected on /dev/sdc at offset 510 . Wipe it? [ y/n ] : y Wiping dos signature on /dev/sdc. Physical volume \"/dev/sdc\" successfully created. abc@abc:~$ sudo pvcreate /dev/sdd WARNING: dos signature detected on /dev/sdd at offset 510 . Wipe it? [ y/n ] : y Wiping dos signature on /dev/sdd. Physical volume \"/dev/sdd\" successfully created. abc@abc:~$ sudo pvcreate /dev/sde WARNING: dos signature detected on /dev/sde at offset 510 . Wipe it? [ y/n ] : y Wiping dos signature on /dev/sde. Physical volume \"/dev/sde\" successfully created. abc@abc:~$ sudo pvcreate /dev/sdf WARNING: dos signature detected on /dev/sdf at offset 510 . Wipe it? [ y/n ] : y Wiping dos signature on /dev/sdf. Physical volume \"/dev/sdf\" successfully created. \u62a5\u9519 1.1 Device /dev/sde excluded by a filter abc@abc:~$ sudo parted /dev/sde GNU Parted 3 .3 Using /dev/sde Welcome to GNU Parted! Type 'help' to view a list of commands. ( parted ) mklabel msdos Warning: Partition ( s ) on /dev/sde are being used. Ignore/Cancel? Ignore Warning: The existing disk label on /dev/sde will be destroyed and all data on this disk will be lost. Do you want to continue ? Yes/No? Yes Error: Partition ( s ) 1 on /dev/sde have been written, but we have been unable to inform the kernel of the change, probably because it/they are in use. As a result, the old partition ( s ) will remain in use. You should reboot now before making further changes. Ignore/Cancel? Ignore ( parted ) quit Information: You may need to update /etc/fstab. 2.\u67e5\u770b\u7269\u7406\u5377 pvs # pvdisplay \u53ef\u4ee5\u66f4\u8be6\u7ec6 \u8bb0\u5f55 abc@abc:~$ sudo pvs PV VG Fmt Attr PSize PFree /dev/sdb lvm2 --- < 3 .64t < 3 .64t /dev/sdc lvm2 --- < 3 .64t < 3 .64t /dev/sdd lvm2 --- < 3 .64t < 3 .64t /dev/sde lvm2 --- < 3 .64t < 3 .64t /dev/sdf lvm2 --- < 3 .64t < 3 .64t 3.\u521b\u5efa\u5377\u7ec4\uff08VG\uff09 //vgcreate [ \u81ea\u5b9a\u4e49LVM\u540d\u79f0 ] [ \u8bbe\u5907 ] //\u5148\u4f7f\u7528\u786c\u76d81\u521b\u5efavg:LVM sudo vgcreate LVM /dev/sdb 4.\u6269\u5c55\u5377\u7ec4\uff08VG\uff09 //vgextend [ \u81ea\u5b9a\u4e49vg\u540d\u79f0 ] [ \u8bbe\u5907 ] //\u4f7f\u7528\u786c\u76d82\u6269\u5c55vg sudo vgextend LVM /dev/sdc sudo vgextend LVM /dev/sdd sudo vgextend LVM /dev/sde sudo vgextend LVM /dev/sdf 5.\u521b\u5efalv //lvcreate -L [ \u81ea\u5b9a\u4e49\u5206\u533a\u5927\u5c0f ] -n [ \u81ea\u5b9a\u4e49\u5206\u533a\u540d\u79f0 ] [ vg\u540d\u79f0 ] //*\u5206\u533a\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc7\u786c\u76d8\u5bb9\u91cf\u603b\u548c* sudo lvcreate -L 5 .0T -n DB LVM // \u6216\u8005\u91c7\u7528\u767e\u5206\u767e\u65b9\u5f0f\u8fdb\u884c sudo lvcreate -l 100 %VG -n DB_DATA LVM 6.\u683c\u5f0f\u5316\u5206\u533a sudo mkfs.ext4 /dev/LVM/DB_DATA 7.\u8bbe\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d vim /etc/fstab \u52a0\u5165 uuid\u65b9\u5f0f abc@abc:~$ sudo blkid /dev/sda2: UUID = \"e1fc5024-b88d-4781-948e-a9dab80baa76\" TYPE = \"swap\" PARTUUID = \"632674e3-689b-8248-bec8-cc673d81b2e2\" /dev/sda1: UUID = \"635E-10AB\" TYPE = \"vfat\" PARTLABEL = \"EFI System Partition\" PARTUUID = \"93b17d02-33ab-4867-9379-2915b2e51fc0\" /dev/sda3: LABEL = \"bpool\" UUID = \"2648003100764060318\" UUID_SUB = \"13443058274032828838\" TYPE = \"zfs_member\" PARTUUID = \"a9865e02-3b35-2d4d-ac78-1829db423ce2\" /dev/sda4: LABEL = \"rpool\" UUID = \"6340906846261585702\" UUID_SUB = \"3921781473015350798\" TYPE = \"zfs_member\" PARTUUID = \"1adbab33-aaf6-ab4d-9d0f-a923cfbf2d17\" /dev/sdb: UUID = \"2DQOj7-Wf3r-ogYb-n0xF-zRl6-hVot-gcQonL\" TYPE = \"LVM2_member\" /dev/loop0: TYPE = \"squashfs\" /dev/loop1: TYPE = \"squashfs\" /dev/loop2: TYPE = \"squashfs\" /dev/loop3: TYPE = \"squashfs\" /dev/loop4: TYPE = \"squashfs\" /dev/loop5: TYPE = \"squashfs\" /dev/loop6: TYPE = \"squashfs\" /dev/loop7: TYPE = \"squashfs\" /dev/sdc: UUID = \"7JwTbl-4aCX-dm6d-onYc-qadM-SVho-xR7Hcp\" TYPE = \"LVM2_member\" /dev/sdd: UUID = \"MaYYjn-BI8u-kO8T-2VPk-Xp6g-Wwrg-ZXW1fs\" TYPE = \"LVM2_member\" /dev/sde: UUID = \"YI7wvU-ODJm-w1PG-4RjV-FLu5-W6mo-98S1sD\" TYPE = \"LVM2_member\" /dev/sdf: UUID = \"6mS1fC-ZHGU-CifE-TTww-bQcP-3ATW-m7gL15\" TYPE = \"LVM2_member\" /dev/loop8: TYPE = \"squashfs\" /dev/loop9: TYPE = \"squashfs\" /dev/mapper/LVM-DB_DATA: UUID = \"9207d950-b182-42f8-ba6b-c2734494c4fe\" TYPE = \"ext4\" /dev/mapper/LVM-DB: UUID = \"cf58f715-7c78-49a8-ad69-762b2ef1700a\" TYPE = \"ext4\" UUID = cf58f715-7c78-49a8-ad69-762b2ef1700a /opt ext4 defaults 0 0 UUID = 9207d950-b182-42f8-ba6b-c2734494c4fe /opt/workspace ext4 defaults 0 0 label \u65b9\u5f0f(\u63a8\u8350) /dev/LVM/DB_DATA /opt ext4 defaults 0 0 /dev/LVM/DB /opt/workspace ext4 defaults 0 0 8\u3001\u589e\u52a0\u786c\u76d8\u6269\u5bb9 sudo pvcreate /dev/sdh # \u589e\u52a0\u786c\u76d8 sudo vgextend LVM /dev/sdh # \u6269\u5c55\u5377\u7ec4\uff08VG\uff09 sudo lvextend -l +100%FREE /dev/LVM/DB_DATA # \u589e\u52a0\u5230\u67d0\u4e2a\u5206\u533a sudo resize2fs /dev/LVM/DB_DATA # \u6539\u53d8\u5927\u5c0f 9.\u5220\u9664\u903b\u8f91\u76d8 sudo lvremove LVM sudo vgremove LVM 10.\u683c\u5f0f\u5316 step1: \u6ce8\u91ca\u6389 /etc/fstab \u4e0a\u9762\u7684\u6302\u8f7d,\u4e4b\u540e\u91cd\u542f\u673a\u5668 step2: \u5220\u9664\u903b\u8f91\u5377 sudo lvremove LVM sudo vgremove LVM step3: \u91cd\u65b0\u914d\u7f6e\u7136\u540e\u683c\u5f0f\u5316 SSHFS \u6302\u8f7d\u8fdc\u7a0b\u5730\u5740 SSHFS \u53ef\u4ee5\u628a\u786c\u76d8\u901a\u8fc7ssh \u7684\u65b9\u5f0f\u8fdb\u884c\u6302\u8f7d sudo apt-get install sshfs sudo sshfs -o allow_other,default_permissions abc@192.168.1.32:/home/abc/data /home/abc/data umount mountpoint \u53ef\u7528\u8d44\u6e90 redhat \u5b98\u65b9\u6302\u8f7d\u6559\u7a0b sshfs github","title":"\u786c\u76d8\u64cd\u4f5c"},{"location":"disk/#_1","text":"","title":"\u786c\u76d8"},{"location":"disk/#_2","text":"","title":"\u591a\u4e2a\u786c\u76d8\u5408\u5e76\u5b9e\u64cd"},{"location":"disk/#0","text":"sudo apt install lvm2","title":"0.\u524d\u63d0\u4f9d\u8d56"},{"location":"disk/#1pv","text":"\u67e5\u770b\u6302\u8f7d\u786c\u76d8 lsblk sudo pvcreate /dev/sdb //\u786c\u76d81 sudo pvcreate /dev/sdc //\u786c\u76d82 sudo pvcreate /dev/sdd //\u786c\u76d83 sudo pvcreate /dev/sdf //\u786c\u76d84 sudo pvcreate /dev/sde //\u786c\u76d85 \u8bb0\u5f55\u5982\u4e0b\uff1a abc@abc:~$ pvcreate /dev/sdb WARNING: Running as a non-root user. Functionality may be unavailable. /run/lock/lvm/P_global:aux: open failed: Permission denied abc@abc:~$ sudo pvcreate /dev/sdb [ sudo ] password for abc: Physical volume \"/dev/sdb\" successfully created. abc@abc:~$ sudo pvcreate /dev/sdc WARNING: dos signature detected on /dev/sdc at offset 510 . Wipe it? [ y/n ] : y Wiping dos signature on /dev/sdc. Physical volume \"/dev/sdc\" successfully created. abc@abc:~$ sudo pvcreate /dev/sdd WARNING: dos signature detected on /dev/sdd at offset 510 . Wipe it? [ y/n ] : y Wiping dos signature on /dev/sdd. Physical volume \"/dev/sdd\" successfully created. abc@abc:~$ sudo pvcreate /dev/sde WARNING: dos signature detected on /dev/sde at offset 510 . Wipe it? [ y/n ] : y Wiping dos signature on /dev/sde. Physical volume \"/dev/sde\" successfully created. abc@abc:~$ sudo pvcreate /dev/sdf WARNING: dos signature detected on /dev/sdf at offset 510 . Wipe it? [ y/n ] : y Wiping dos signature on /dev/sdf. Physical volume \"/dev/sdf\" successfully created. \u62a5\u9519 1.1 Device /dev/sde excluded by a filter abc@abc:~$ sudo parted /dev/sde GNU Parted 3 .3 Using /dev/sde Welcome to GNU Parted! Type 'help' to view a list of commands. ( parted ) mklabel msdos Warning: Partition ( s ) on /dev/sde are being used. Ignore/Cancel? Ignore Warning: The existing disk label on /dev/sde will be destroyed and all data on this disk will be lost. Do you want to continue ? Yes/No? Yes Error: Partition ( s ) 1 on /dev/sde have been written, but we have been unable to inform the kernel of the change, probably because it/they are in use. As a result, the old partition ( s ) will remain in use. You should reboot now before making further changes. Ignore/Cancel? Ignore ( parted ) quit Information: You may need to update /etc/fstab.","title":"1.\u521b\u5efapv"},{"location":"disk/#2","text":"pvs # pvdisplay \u53ef\u4ee5\u66f4\u8be6\u7ec6 \u8bb0\u5f55 abc@abc:~$ sudo pvs PV VG Fmt Attr PSize PFree /dev/sdb lvm2 --- < 3 .64t < 3 .64t /dev/sdc lvm2 --- < 3 .64t < 3 .64t /dev/sdd lvm2 --- < 3 .64t < 3 .64t /dev/sde lvm2 --- < 3 .64t < 3 .64t /dev/sdf lvm2 --- < 3 .64t < 3 .64t","title":"2.\u67e5\u770b\u7269\u7406\u5377"},{"location":"disk/#3vg","text":"//vgcreate [ \u81ea\u5b9a\u4e49LVM\u540d\u79f0 ] [ \u8bbe\u5907 ] //\u5148\u4f7f\u7528\u786c\u76d81\u521b\u5efavg:LVM sudo vgcreate LVM /dev/sdb","title":"3.\u521b\u5efa\u5377\u7ec4\uff08VG\uff09"},{"location":"disk/#4vg","text":"//vgextend [ \u81ea\u5b9a\u4e49vg\u540d\u79f0 ] [ \u8bbe\u5907 ] //\u4f7f\u7528\u786c\u76d82\u6269\u5c55vg sudo vgextend LVM /dev/sdc sudo vgextend LVM /dev/sdd sudo vgextend LVM /dev/sde sudo vgextend LVM /dev/sdf","title":"4.\u6269\u5c55\u5377\u7ec4\uff08VG\uff09"},{"location":"disk/#5lv","text":"//lvcreate -L [ \u81ea\u5b9a\u4e49\u5206\u533a\u5927\u5c0f ] -n [ \u81ea\u5b9a\u4e49\u5206\u533a\u540d\u79f0 ] [ vg\u540d\u79f0 ] //*\u5206\u533a\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc7\u786c\u76d8\u5bb9\u91cf\u603b\u548c* sudo lvcreate -L 5 .0T -n DB LVM // \u6216\u8005\u91c7\u7528\u767e\u5206\u767e\u65b9\u5f0f\u8fdb\u884c sudo lvcreate -l 100 %VG -n DB_DATA LVM","title":"5.\u521b\u5efalv"},{"location":"disk/#6","text":"sudo mkfs.ext4 /dev/LVM/DB_DATA","title":"6.\u683c\u5f0f\u5316\u5206\u533a"},{"location":"disk/#7","text":"vim /etc/fstab \u52a0\u5165 uuid\u65b9\u5f0f abc@abc:~$ sudo blkid /dev/sda2: UUID = \"e1fc5024-b88d-4781-948e-a9dab80baa76\" TYPE = \"swap\" PARTUUID = \"632674e3-689b-8248-bec8-cc673d81b2e2\" /dev/sda1: UUID = \"635E-10AB\" TYPE = \"vfat\" PARTLABEL = \"EFI System Partition\" PARTUUID = \"93b17d02-33ab-4867-9379-2915b2e51fc0\" /dev/sda3: LABEL = \"bpool\" UUID = \"2648003100764060318\" UUID_SUB = \"13443058274032828838\" TYPE = \"zfs_member\" PARTUUID = \"a9865e02-3b35-2d4d-ac78-1829db423ce2\" /dev/sda4: LABEL = \"rpool\" UUID = \"6340906846261585702\" UUID_SUB = \"3921781473015350798\" TYPE = \"zfs_member\" PARTUUID = \"1adbab33-aaf6-ab4d-9d0f-a923cfbf2d17\" /dev/sdb: UUID = \"2DQOj7-Wf3r-ogYb-n0xF-zRl6-hVot-gcQonL\" TYPE = \"LVM2_member\" /dev/loop0: TYPE = \"squashfs\" /dev/loop1: TYPE = \"squashfs\" /dev/loop2: TYPE = \"squashfs\" /dev/loop3: TYPE = \"squashfs\" /dev/loop4: TYPE = \"squashfs\" /dev/loop5: TYPE = \"squashfs\" /dev/loop6: TYPE = \"squashfs\" /dev/loop7: TYPE = \"squashfs\" /dev/sdc: UUID = \"7JwTbl-4aCX-dm6d-onYc-qadM-SVho-xR7Hcp\" TYPE = \"LVM2_member\" /dev/sdd: UUID = \"MaYYjn-BI8u-kO8T-2VPk-Xp6g-Wwrg-ZXW1fs\" TYPE = \"LVM2_member\" /dev/sde: UUID = \"YI7wvU-ODJm-w1PG-4RjV-FLu5-W6mo-98S1sD\" TYPE = \"LVM2_member\" /dev/sdf: UUID = \"6mS1fC-ZHGU-CifE-TTww-bQcP-3ATW-m7gL15\" TYPE = \"LVM2_member\" /dev/loop8: TYPE = \"squashfs\" /dev/loop9: TYPE = \"squashfs\" /dev/mapper/LVM-DB_DATA: UUID = \"9207d950-b182-42f8-ba6b-c2734494c4fe\" TYPE = \"ext4\" /dev/mapper/LVM-DB: UUID = \"cf58f715-7c78-49a8-ad69-762b2ef1700a\" TYPE = \"ext4\" UUID = cf58f715-7c78-49a8-ad69-762b2ef1700a /opt ext4 defaults 0 0 UUID = 9207d950-b182-42f8-ba6b-c2734494c4fe /opt/workspace ext4 defaults 0 0 label \u65b9\u5f0f(\u63a8\u8350) /dev/LVM/DB_DATA /opt ext4 defaults 0 0 /dev/LVM/DB /opt/workspace ext4 defaults 0 0","title":"7.\u8bbe\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d"},{"location":"disk/#8","text":"sudo pvcreate /dev/sdh # \u589e\u52a0\u786c\u76d8 sudo vgextend LVM /dev/sdh # \u6269\u5c55\u5377\u7ec4\uff08VG\uff09 sudo lvextend -l +100%FREE /dev/LVM/DB_DATA # \u589e\u52a0\u5230\u67d0\u4e2a\u5206\u533a sudo resize2fs /dev/LVM/DB_DATA # \u6539\u53d8\u5927\u5c0f","title":"8\u3001\u589e\u52a0\u786c\u76d8\u6269\u5bb9"},{"location":"disk/#9","text":"sudo lvremove LVM sudo vgremove LVM","title":"9.\u5220\u9664\u903b\u8f91\u76d8"},{"location":"disk/#10","text":"step1: \u6ce8\u91ca\u6389 /etc/fstab \u4e0a\u9762\u7684\u6302\u8f7d,\u4e4b\u540e\u91cd\u542f\u673a\u5668 step2: \u5220\u9664\u903b\u8f91\u5377 sudo lvremove LVM sudo vgremove LVM step3: \u91cd\u65b0\u914d\u7f6e\u7136\u540e\u683c\u5f0f\u5316","title":"10.\u683c\u5f0f\u5316"},{"location":"disk/#sshfs","text":"SSHFS \u53ef\u4ee5\u628a\u786c\u76d8\u901a\u8fc7ssh \u7684\u65b9\u5f0f\u8fdb\u884c\u6302\u8f7d sudo apt-get install sshfs sudo sshfs -o allow_other,default_permissions abc@192.168.1.32:/home/abc/data /home/abc/data umount mountpoint","title":"SSHFS \u6302\u8f7d\u8fdc\u7a0b\u5730\u5740"},{"location":"disk/#_3","text":"redhat \u5b98\u65b9\u6302\u8f7d\u6559\u7a0b sshfs github","title":"\u53ef\u7528\u8d44\u6e90"},{"location":"limit/","text":"\u9650\u5236 \u5f53\u673a\u5668\u8fdb\u884c\u591a\u6316\u7684\u65f6\u5019\uff0c\u5982\u679c\u4e0d\u5bf9\u67d0\u4e2a\u5e94\u7528\u8fdb\u884c\u8d44\u6e90\u9650\u5b9a\uff0c\u90a3\u4e48\u4e00\u4e2a\u5e94\u7528\u5360\u7528\u592a\u591a\u8d44\u6e90\uff0c\u4f1a\u5bfc\u81f4\u5176\u4ed6\u5e94\u7528\u51fa\u73b0\u8d44\u6e90\u4e0d\u591f \u7f51\u7edc\u9650\u5236\u901f\u5ea6 wondershaper [\u63a5\u53e3] [\u4e0a\u4f20\u901f\u5ea6 K] [\u4e0b\u8f7d\u901f\u5ea6 K] \u63a5\u53e3\u6307\u7f51\u7edc\u8fde\u63a5\u7684\u63a5\u53e3, \u4e5f\u5c31\u662f\u4e0e\u8c03\u5236\u89e3\u8c03\u5668\u8fde\u63a5 (\u4ece\u800c\u548c\u56e0\u7279\u7f51\u8fde\u63a5) \u7684\u7f51\u5361. \u67e5\u627e\u547d\u4ee4\u7528\u7684\u662f ifconfig sudo apt-get install wondershaper sudo wondershaper enp2s0 10240 10240 \uff08\u9650\u5236enp2s0\u7f51\u5361\u4e0b\u8f7d\u901f\u5ea610240K\uff0c\u4e0a\u4f20\u901f\u5ea610240K\uff09 sudo wondershaper clear enp2s0 (\u6e05\u9664\u7f51\u7edc\u9650\u5236) \u9650\u5236CPU\u4f7f\u7528 sudo apt-get install cpulimit # PID=1111 \u7684 CPU \u4e0a\u9650 50% cpulimit --pid 1111 --limit 50 # \u540e\u53f0\u8fd0\u884c cpulimit --pid 1111 --limit 50 --background # \u6e05\u7406\u9650\u5236 cpulimit --pid 1111 --limit 50 --kill #!/usr/bin/env bash set -e echo \"*** \u5f00\u59cb\u9650\u5236CPU ***\" # shellcheck disable=SC2034 sworker_pid = $( pidof crust-sworker ) sudo cpulimit --pid $sworker_pid --limit 60 --background crust_pid = $( pidof crust ) sudo cpulimit --pid $crust_pid --limit 50 --background \u6bd4\u5982 crust limit_cpu \u751f\u4ea7\u4e0b\u811a\u672c","title":"\u8d44\u6e90\u9650\u5236"},{"location":"limit/#_1","text":"\u5f53\u673a\u5668\u8fdb\u884c\u591a\u6316\u7684\u65f6\u5019\uff0c\u5982\u679c\u4e0d\u5bf9\u67d0\u4e2a\u5e94\u7528\u8fdb\u884c\u8d44\u6e90\u9650\u5b9a\uff0c\u90a3\u4e48\u4e00\u4e2a\u5e94\u7528\u5360\u7528\u592a\u591a\u8d44\u6e90\uff0c\u4f1a\u5bfc\u81f4\u5176\u4ed6\u5e94\u7528\u51fa\u73b0\u8d44\u6e90\u4e0d\u591f","title":"\u9650\u5236"},{"location":"limit/#_2","text":"wondershaper [\u63a5\u53e3] [\u4e0a\u4f20\u901f\u5ea6 K] [\u4e0b\u8f7d\u901f\u5ea6 K] \u63a5\u53e3\u6307\u7f51\u7edc\u8fde\u63a5\u7684\u63a5\u53e3, \u4e5f\u5c31\u662f\u4e0e\u8c03\u5236\u89e3\u8c03\u5668\u8fde\u63a5 (\u4ece\u800c\u548c\u56e0\u7279\u7f51\u8fde\u63a5) \u7684\u7f51\u5361. \u67e5\u627e\u547d\u4ee4\u7528\u7684\u662f ifconfig sudo apt-get install wondershaper sudo wondershaper enp2s0 10240 10240 \uff08\u9650\u5236enp2s0\u7f51\u5361\u4e0b\u8f7d\u901f\u5ea610240K\uff0c\u4e0a\u4f20\u901f\u5ea610240K\uff09 sudo wondershaper clear enp2s0 (\u6e05\u9664\u7f51\u7edc\u9650\u5236)","title":"\u7f51\u7edc\u9650\u5236\u901f\u5ea6"},{"location":"limit/#cpu","text":"sudo apt-get install cpulimit # PID=1111 \u7684 CPU \u4e0a\u9650 50% cpulimit --pid 1111 --limit 50 # \u540e\u53f0\u8fd0\u884c cpulimit --pid 1111 --limit 50 --background # \u6e05\u7406\u9650\u5236 cpulimit --pid 1111 --limit 50 --kill #!/usr/bin/env bash set -e echo \"*** \u5f00\u59cb\u9650\u5236CPU ***\" # shellcheck disable=SC2034 sworker_pid = $( pidof crust-sworker ) sudo cpulimit --pid $sworker_pid --limit 60 --background crust_pid = $( pidof crust ) sudo cpulimit --pid $crust_pid --limit 50 --background \u6bd4\u5982 crust limit_cpu \u751f\u4ea7\u4e0b\u811a\u672c","title":"\u9650\u5236CPU\u4f7f\u7528"},{"location":"logs/","text":"\u65e5\u5fd7 TODO","title":"\u65e5\u5fd7\u5904\u7406"},{"location":"logs/#_1","text":"TODO","title":"\u65e5\u5fd7"},{"location":"nginx/","text":"nginx \u53bb \u5b98\u65b9\u4e0b\u8f7d \u6700\u65b0\u7a33\u5b9a\u7684\u7248\u672c,\u8fdb\u884c\u7f16\u8bd1\u5b89\u88c5\u3002\u5b89\u88c5\u4e4b\u540e\uff0c\u53c2\u8003 nginx/nginx.conf \u8fdb\u884c\u914d\u7f6e. \u4e4b\u540e\u8fdb\u884c\u91cd\u65b0\u52a0\u8f7d nginx -s reload \u4e4b\u540e\u8bbf\u95ee miner.your.domain \u5c31\u662f\u4f60\u7684grafana\u76d1\u63a7\u9875\u9762","title":"nginx"},{"location":"nginx/#nginx","text":"\u53bb \u5b98\u65b9\u4e0b\u8f7d \u6700\u65b0\u7a33\u5b9a\u7684\u7248\u672c,\u8fdb\u884c\u7f16\u8bd1\u5b89\u88c5\u3002\u5b89\u88c5\u4e4b\u540e\uff0c\u53c2\u8003 nginx/nginx.conf \u8fdb\u884c\u914d\u7f6e. \u4e4b\u540e\u8fdb\u884c\u91cd\u65b0\u52a0\u8f7d nginx -s reload \u4e4b\u540e\u8bbf\u95ee miner.your.domain \u5c31\u662f\u4f60\u7684grafana\u76d1\u63a7\u9875\u9762","title":"nginx"},{"location":"startup/","text":"\u6bcd\u76d8\u5236\u4f5c \u7cfb\u7edf \u5b89\u88c5\u4f9d\u8d56 sudo bin/install.sh \u8bbe\u7f6essh\u514d\u5bc6\u7801 ssh-keygen -t rsa cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys \u8bbe\u7f6e\u7528\u6237\u514d\u5bc6\u7801 root \u4e0b\u8fdb\u884c chmod u+w /etc/sudoers \u627e\u5230root\u7528\u6237 root ALL=(ALL) ALL \u5728root\u7528\u6237\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9 abc ALL=(ALL) ALL \u6216 abc ALL=(ALL) NOPASSWD:ALL \u7b2c\u4e00\u79cd\u5728sudo\u7684\u65f6\u5019\u9700\u8981\u8f93\u5165\u5bc6\u7801 \u7b2c\u4e8c\u79cd\u5728sudo\u7684\u65f6\u5019\u4e0d\u9700\u8981\u8f93\u5165\u5bc6\u7801, \u63a8\u8350\u8bbe\u7f6e\uff1a # User privilege specification root ALL =( ALL:ALL ) ALL abc ALL =( ALL ) NOPASSWD:ALL # Members of the admin group may gain root privileges %admin ALL =( ALL ) NOPASSWD:ALL # Allow members of group sudo to execute any command %sudo ALL =( ALL:ALL ) NOPASSWD:ALL chmod u-w /etc/sudoers Ubuntu \u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\u52a8 \u65b9\u6848\u4e00 1\u3001\u5728/etc/systemd/system\u76ee\u5f55\u4e0b\u521b\u5efarc.local.service\u670d\u52a1\u7684\u8f6f\u94fe\u63a5\u3002 ln -s /lib/systemd/system/rc.local.service /etc/systemd/system/ systemctl enable rc-local.service \u9488\u5bf9 registrator.sh,\u9700\u8981\u5f00\u673a\u81ea\u52a8\u8d77 sudo chmod 755 registrator.sh sudo cp registrator.sh /etc/init.d/ sudo update-rc.d registrator.sh defaults 100 \u5982\u679c\u8981\u79fb\u9664\uff0c\u6267\u884c sudo update-rc.d -f registrator.sh remove \u65b9\u6848\u4e8c 1\u3001\u68c0\u67e5\u7cfb\u7edf\u76ee\u5f55/lib/systemd/system/rc-local.service,\u5982\u679c\u6ca1\u6709\u81ea\u5df1\u521b\u5efa \u5185\u5bb9\u5982\u4e0b\uff0c\u5982\u679c\u6ca1\u6709Install \u52a0\u4e0a vim /etc/systemd/system/rc-local.service # SPDX-License-Identifier: LGPL-2.1+ # # This file is part of systemd. # # systemd is free software; you can redistribute it and/or modify it # under the terms of the GNU Lesser General Public License as published by # the Free Software Foundation; either version 2.1 of the License, or # (at your option) any later version. # This unit gets pulled automatically into multi-user.target by # systemd-rc-local-generator if /etc/rc.local is executable. [ Unit ] Description = /etc/rc.local Compatibility Documentation = man:systemd-rc-local-generator ( 8 ) ConditionFileIsExecutable = /etc/rc.local After = network.target [ Service ] Type = forking ExecStart = /etc/rc.local start TimeoutSec = 0 RemainAfterExit = yes GuessMainPID = no [ Install ] WantedBy = multi-user.target Alias = rc-local.service \u5236\u5b9a systemctl enable rc-local.service 2\u3001\u589e\u52a0\u5982\u4e0b\u5185\u5bb9 chmod +x /etc/rc.local vim /etc/rc.local \u4e0b\u9762\u8bbe\u7f6e\u4e3a /usr/local/bin/start_miner \u4e3a\u81ea\u542f\u52a8\u811a\u672c \u5982\u4e0b: #!/bin/bash # rc.local # # This script is executed at the end of each multiuser runlevel. # Make sure that the script will \"exit 0\" on success or any other # value on error. # # In order to enable or disable this script just change the execution # bits. # # By default this script does nothing. sudo /usr/local/bin/start_miner & exit 0 systemctl start rc-local \u5f00\u542f\u670d\u52a1 systemctl stop rc-local \u5173\u95ed\u670d\u52a1 systemctl restart rc-local \u91cd\u542f\u670d\u52a1 systemctl status rc-local \u67e5\u770b\u670d\u52a1\u72b6\u6001 systemctl enable rc-local \u5c06\u670d\u52a1\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f\u52a8 systemctl disable rc-local \u7981\u6b62\u670d\u52a1\u5f00\u673a\u81ea\u542f\u52a8 systemctl is-enabled rc-local \u67e5\u770b\u670d\u52a1\u662f\u5426\u5f00\u673a\u542f\u52a8 systemctl list-unit-files | grep enabled \u67e5\u770b\u5f00\u673a\u542f\u52a8\u7684\u670d\u52a1\u5217\u8868 systemctl --failed \u67e5\u770b\u542f\u52a8\u5931\u8d25\u7684\u670d\u52a1\u5217\u8868","title":"\u6bcd\u76d8\u5236\u4f5c"},{"location":"startup/#_1","text":"","title":"\u6bcd\u76d8\u5236\u4f5c"},{"location":"startup/#_2","text":"","title":"\u7cfb\u7edf"},{"location":"startup/#_3","text":"sudo bin/install.sh","title":"\u5b89\u88c5\u4f9d\u8d56"},{"location":"startup/#ssh","text":"ssh-keygen -t rsa cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys","title":"\u8bbe\u7f6essh\u514d\u5bc6\u7801"},{"location":"startup/#_4","text":"root \u4e0b\u8fdb\u884c chmod u+w /etc/sudoers \u627e\u5230root\u7528\u6237 root ALL=(ALL) ALL \u5728root\u7528\u6237\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9 abc ALL=(ALL) ALL \u6216 abc ALL=(ALL) NOPASSWD:ALL \u7b2c\u4e00\u79cd\u5728sudo\u7684\u65f6\u5019\u9700\u8981\u8f93\u5165\u5bc6\u7801 \u7b2c\u4e8c\u79cd\u5728sudo\u7684\u65f6\u5019\u4e0d\u9700\u8981\u8f93\u5165\u5bc6\u7801, \u63a8\u8350\u8bbe\u7f6e\uff1a # User privilege specification root ALL =( ALL:ALL ) ALL abc ALL =( ALL ) NOPASSWD:ALL # Members of the admin group may gain root privileges %admin ALL =( ALL ) NOPASSWD:ALL # Allow members of group sudo to execute any command %sudo ALL =( ALL:ALL ) NOPASSWD:ALL chmod u-w /etc/sudoers","title":"\u8bbe\u7f6e\u7528\u6237\u514d\u5bc6\u7801"},{"location":"startup/#ubuntu","text":"\u65b9\u6848\u4e00 1\u3001\u5728/etc/systemd/system\u76ee\u5f55\u4e0b\u521b\u5efarc.local.service\u670d\u52a1\u7684\u8f6f\u94fe\u63a5\u3002 ln -s /lib/systemd/system/rc.local.service /etc/systemd/system/ systemctl enable rc-local.service \u9488\u5bf9 registrator.sh,\u9700\u8981\u5f00\u673a\u81ea\u52a8\u8d77 sudo chmod 755 registrator.sh sudo cp registrator.sh /etc/init.d/ sudo update-rc.d registrator.sh defaults 100 \u5982\u679c\u8981\u79fb\u9664\uff0c\u6267\u884c sudo update-rc.d -f registrator.sh remove \u65b9\u6848\u4e8c 1\u3001\u68c0\u67e5\u7cfb\u7edf\u76ee\u5f55/lib/systemd/system/rc-local.service,\u5982\u679c\u6ca1\u6709\u81ea\u5df1\u521b\u5efa \u5185\u5bb9\u5982\u4e0b\uff0c\u5982\u679c\u6ca1\u6709Install \u52a0\u4e0a vim /etc/systemd/system/rc-local.service # SPDX-License-Identifier: LGPL-2.1+ # # This file is part of systemd. # # systemd is free software; you can redistribute it and/or modify it # under the terms of the GNU Lesser General Public License as published by # the Free Software Foundation; either version 2.1 of the License, or # (at your option) any later version. # This unit gets pulled automatically into multi-user.target by # systemd-rc-local-generator if /etc/rc.local is executable. [ Unit ] Description = /etc/rc.local Compatibility Documentation = man:systemd-rc-local-generator ( 8 ) ConditionFileIsExecutable = /etc/rc.local After = network.target [ Service ] Type = forking ExecStart = /etc/rc.local start TimeoutSec = 0 RemainAfterExit = yes GuessMainPID = no [ Install ] WantedBy = multi-user.target Alias = rc-local.service \u5236\u5b9a systemctl enable rc-local.service 2\u3001\u589e\u52a0\u5982\u4e0b\u5185\u5bb9 chmod +x /etc/rc.local vim /etc/rc.local \u4e0b\u9762\u8bbe\u7f6e\u4e3a /usr/local/bin/start_miner \u4e3a\u81ea\u542f\u52a8\u811a\u672c \u5982\u4e0b: #!/bin/bash # rc.local # # This script is executed at the end of each multiuser runlevel. # Make sure that the script will \"exit 0\" on success or any other # value on error. # # In order to enable or disable this script just change the execution # bits. # # By default this script does nothing. sudo /usr/local/bin/start_miner & exit 0 systemctl start rc-local \u5f00\u542f\u670d\u52a1 systemctl stop rc-local \u5173\u95ed\u670d\u52a1 systemctl restart rc-local \u91cd\u542f\u670d\u52a1 systemctl status rc-local \u67e5\u770b\u670d\u52a1\u72b6\u6001 systemctl enable rc-local \u5c06\u670d\u52a1\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f\u52a8 systemctl disable rc-local \u7981\u6b62\u670d\u52a1\u5f00\u673a\u81ea\u542f\u52a8 systemctl is-enabled rc-local \u67e5\u770b\u670d\u52a1\u662f\u5426\u5f00\u673a\u542f\u52a8 systemctl list-unit-files | grep enabled \u67e5\u770b\u5f00\u673a\u542f\u52a8\u7684\u670d\u52a1\u5217\u8868 systemctl --failed \u67e5\u770b\u542f\u52a8\u5931\u8d25\u7684\u670d\u52a1\u5217\u8868","title":"Ubuntu \u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\u52a8"},{"location":"ansible/","text":"ansible ansible \u662f\u4e00\u4e2a\u81ea\u52a8\u5316\u5de5\u5177\uff0c\u5177\u4f53\u53ef\u4ee5\u67e5\u770b\u5b98\u65b9\u6587\u6863 ansible \u5b98\u65b9\u6587\u6863 \u5b89\u88c5 sudo apt install ansible \u5168\u5c40\u914d\u7f6e /etc/ansible/ansible.cfg \u6216\u8005 ~/.ansible.cfg : [ defaults ] host_key_checking = False inventory \u914d\u7f6e /etc/ansible/hosts mail.example.com [ webservers ] foo.example.com bar.example.com [ dbservers ] one.example.com two.example.com three.example.com \u7136\u540e\u53ef\u4ee5ping ansible all -m ping ansible dbservers -m ping \u8d44\u6e90 ansible-cn ansible user guide","title":"\u8fd0\u7ef4"},{"location":"ansible/#ansible","text":"ansible \u662f\u4e00\u4e2a\u81ea\u52a8\u5316\u5de5\u5177\uff0c\u5177\u4f53\u53ef\u4ee5\u67e5\u770b\u5b98\u65b9\u6587\u6863 ansible \u5b98\u65b9\u6587\u6863","title":"ansible"},{"location":"ansible/#_1","text":"sudo apt install ansible","title":"\u5b89\u88c5"},{"location":"ansible/#_2","text":"/etc/ansible/ansible.cfg \u6216\u8005 ~/.ansible.cfg : [ defaults ] host_key_checking = False","title":"\u5168\u5c40\u914d\u7f6e"},{"location":"ansible/#inventory","text":"/etc/ansible/hosts mail.example.com [ webservers ] foo.example.com bar.example.com [ dbservers ] one.example.com two.example.com three.example.com \u7136\u540e\u53ef\u4ee5ping ansible all -m ping ansible dbservers -m ping","title":"inventory \u914d\u7f6e"},{"location":"ansible/#_3","text":"ansible-cn ansible user guide","title":"\u8d44\u6e90"},{"location":"ansible/batch/","text":"\u4f7f\u7528ansible\u6279\u91cf\u7ba1\u7406\u8fdc\u7a0b\u670d\u52a1\u5668 \u5e38\u7528\u6a21\u5757 copy\u6a21\u5757 ansible myservers -m copy -a \"src=/opt/ dest=/opt mode=0755\" ansible [ \u7ec4 ] -m copy -a \"src=\u672c\u5730 dest=\u76ee\u7684\u5730 mode=0755\" command\u6a21\u5757(\u4e0d\u652f\u6301\u7ba1\u9053) command\u6a21\u5757\u4e3aansible\u9ed8\u8ba4\u6a21\u5757\uff0c\u4e0d\u6307\u5b9a-m\u53c2\u6570\u65f6\uff0c\u4f7f\u7528\u7684\u5c31\u662fcommand\u6a21\u5757\uff1b ansible myservers -a 'pwd' shell\u6a21\u5757(\u652f\u6301\u7ba1\u9053) \u4f7f\u7528shell\u6a21\u5757\uff0c\u5728\u8fdc\u7a0b\u547d\u4ee4\u901a\u8fc7/bin/sh\u6765\u6267\u884c ansible myservers -a \"ps aux\" -m shell scripts\u6a21\u5757 \u4f7f\u7528scripts\u6a21\u5757\u53ef\u4ee5\u5728\u672c\u5730\u5199\u4e00\u4e2a\u811a\u672c,\u5bf9\u4e8e\u51e0\u5341\u884c\u7684\u4ee3\u7801\u4ee5\u4e0a\u903b\u8f91\u662f\u975e\u5e38\u6709\u7528\u7684\uff0c\u5728\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u6267\u884c\uff1a ansible myservers -m script -a \"/opt/my_local.sh\" \u53ef\u7528\u8d44\u6e90 \u6279\u91cf\u6267\u884cplaybooks ansible-examples","title":"\u6279\u91cf\u5904\u7406"},{"location":"ansible/batch/#ansible","text":"","title":"\u4f7f\u7528ansible\u6279\u91cf\u7ba1\u7406\u8fdc\u7a0b\u670d\u52a1\u5668"},{"location":"ansible/batch/#_1","text":"","title":"\u5e38\u7528\u6a21\u5757"},{"location":"ansible/batch/#copy","text":"ansible myservers -m copy -a \"src=/opt/ dest=/opt mode=0755\" ansible [ \u7ec4 ] -m copy -a \"src=\u672c\u5730 dest=\u76ee\u7684\u5730 mode=0755\"","title":"copy\u6a21\u5757"},{"location":"ansible/batch/#command","text":"command\u6a21\u5757\u4e3aansible\u9ed8\u8ba4\u6a21\u5757\uff0c\u4e0d\u6307\u5b9a-m\u53c2\u6570\u65f6\uff0c\u4f7f\u7528\u7684\u5c31\u662fcommand\u6a21\u5757\uff1b ansible myservers -a 'pwd'","title":"command\u6a21\u5757(\u4e0d\u652f\u6301\u7ba1\u9053)"},{"location":"ansible/batch/#shell","text":"\u4f7f\u7528shell\u6a21\u5757\uff0c\u5728\u8fdc\u7a0b\u547d\u4ee4\u901a\u8fc7/bin/sh\u6765\u6267\u884c ansible myservers -a \"ps aux\" -m shell","title":"shell\u6a21\u5757(\u652f\u6301\u7ba1\u9053)"},{"location":"ansible/batch/#scripts","text":"\u4f7f\u7528scripts\u6a21\u5757\u53ef\u4ee5\u5728\u672c\u5730\u5199\u4e00\u4e2a\u811a\u672c,\u5bf9\u4e8e\u51e0\u5341\u884c\u7684\u4ee3\u7801\u4ee5\u4e0a\u903b\u8f91\u662f\u975e\u5e38\u6709\u7528\u7684\uff0c\u5728\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u6267\u884c\uff1a ansible myservers -m script -a \"/opt/my_local.sh\"","title":"scripts\u6a21\u5757"},{"location":"ansible/batch/#_2","text":"","title":"\u53ef\u7528\u8d44\u6e90"},{"location":"ansible/batch/#playbooks","text":"ansible-examples","title":"\u6279\u91cf\u6267\u884cplaybooks"},{"location":"ansible/demo/","text":"ansible\u6848\u4f8b \u67e5\u770b\u6240\u6709\u673a\u5668\u662f\u5426\u53ef\u4ee5\u94fe\u63a5\u5916\u7f51 ansible myservers -a \"timeout 2 ping www.baidu.com\" -m shell","title":"\u6848\u5217"},{"location":"ansible/demo/#ansible","text":"","title":"ansible\u6848\u4f8b"},{"location":"ansible/demo/#_1","text":"ansible myservers -a \"timeout 2 ping www.baidu.com\" -m shell","title":"\u67e5\u770b\u6240\u6709\u673a\u5668\u662f\u5426\u53ef\u4ee5\u94fe\u63a5\u5916\u7f51"},{"location":"dashboard/","text":"dashboard grafana \u662f\u4e00\u4e2a\u53ef\u89c2\u5bdf\u548c\u6570\u636e\u53ef\u89c6\u5316\u5e73\u53f0\u3002\u6570\u636e\u6e90\u53ef\u4ee5\u6765\u81ea Prometheus\u3001Loki\u3001Elasticsearch\u3001InfluxDB\u3001Postgres \u7b49\u591a\u4e2a\u6e90\u5934 \u5bf9\u4e8e\u53ef\u4ee5\u5c55\u793a\u90a3\u4e9b\uff0c\u53ef\u4ee5\u67e5\u770b \u5b98\u65b9 grafana play . \u540c\u65f6\u5b98\u65b9\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f00\u6e90\u793e\u533a\u7684\u6536\u96c6\u70b9 Official & community built dashboards TODO","title":"\u76d1\u63a7dashboard"},{"location":"dashboard/#dashboard","text":"grafana \u662f\u4e00\u4e2a\u53ef\u89c2\u5bdf\u548c\u6570\u636e\u53ef\u89c6\u5316\u5e73\u53f0\u3002\u6570\u636e\u6e90\u53ef\u4ee5\u6765\u81ea Prometheus\u3001Loki\u3001Elasticsearch\u3001InfluxDB\u3001Postgres \u7b49\u591a\u4e2a\u6e90\u5934 \u5bf9\u4e8e\u53ef\u4ee5\u5c55\u793a\u90a3\u4e9b\uff0c\u53ef\u4ee5\u67e5\u770b \u5b98\u65b9 grafana play . \u540c\u65f6\u5b98\u65b9\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f00\u6e90\u793e\u533a\u7684\u6536\u96c6\u70b9 Official & community built dashboards TODO","title":"dashboard"},{"location":"jumpserver/","text":"jumpserver jumpserver \u662f\u5168\u7403\u9996\u6b3e\u5f00\u6e90\u7684\u5821\u5792\u673a\uff0c\u662f\u7b26\u5408 4A \u7684\u4e13\u4e1a\u8fd0\u7ef4\u5b89\u5168\u5ba1\u8ba1\u7cfb\u7edf\u3002","title":"\u5821\u5792\u673aJumpServer"},{"location":"jumpserver/#jumpserver","text":"jumpserver \u662f\u5168\u7403\u9996\u6b3e\u5f00\u6e90\u7684\u5821\u5792\u673a\uff0c\u662f\u7b26\u5408 4A \u7684\u4e13\u4e1a\u8fd0\u7ef4\u5b89\u5168\u5ba1\u8ba1\u7cfb\u7edf\u3002","title":"jumpserver"},{"location":"script/","text":"\u5e38\u7528\u8fd0\u7ef4\u547d\u4ee4 \u5f53\u6211\u4eec\u5728\u8fd0\u884c\u673a\u5668\u7684\u65f6\u5019\uff0c\u5e73\u65f6\u53ef\u80fd\u8981\u5904\u7406\u4e00\u4e9b\u57fa\u672c\u7684\u903b\u8f91\u3002\u5bf9\u4e8e\u8fd9\u5feb\u53ef\u80fd\u5c31\u5c5e\u4e8e\u4e00\u4e2a\u4f53\u529b\u6d3b\u4e86\uff0c\u4e0d\u8fc7\u5982\u679c\u80fd\u628a\u4e00\u4e9b\u5e38\u7528\u547d\u4ee4\u8fdb\u884c\u5f52\u6863\uff0c\u90a3\u4e48\u4e0b\u6b21\u4f7f\u7528\u7684\u662f\u5c31\u53ef\u4ee5\u76f4\u63a5\u62ff\u6765\u7528\u3002\u5982\u679c\u8fd9\u4e9b\u547d\u4ee4\u90fd\u662f\u5efa\u7acb\u5728linux \u547d\u4ee4\u7684\u57fa\u7840\u4e0a\uff0c\u6240\u4ee5\u5982\u679c\u5bf9\u8fd9\u5feb\u4e0d\u662f\u5f88\u719f\u6089\u7684\uff0c\u63a8\u8350\u7ffb\u9605 linuxcool \u8fdb\u884c\u5904\u7406. \u5e38\u7528\u547d\u4ee4 \u67e5\u770b\u7cfb\u7edf\u5f53\u524d\u7f51\u7edc\u8fde\u63a5\u6570 netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' \u6309\u7167 CPU/\u5185\u5b58\u7684\u4f7f\u7528\u60c5\u51b5\u5217\u51fa\u524d 10 \u7684\u8fdb\u7a0b #\u5185\u5b58 ps axo %mem,pid,euser,cmd | sort -nr | head -10 #CPU ps -aeo pcpu,user,pid,cmd | sort -nr | head -10 \u663e\u793a\u7cfb\u7edf\u6574\u4f53\u7684 CPU \u5229\u7528\u7387\u548c\u95f2\u7f6e\u7387 grep \"cpu \" /proc/stat | awk -F ' ' '{total = $2 + $3 + $4 + $5} END {print \"idle \\t used\\n\" $5*100/total \"% \" $2*100/total \"%\"}' \u5feb\u901f\u6740\u6b7b\u6240\u6709\u7684 xx \u8fdb\u7a0b ps aux | grep xx | awk '{ print $2 }' | xargs kill -9 \u67e5\u627e/\u76ee\u5f55\u4e0b\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u6700\u5927\u7684top10\u6587\u4ef6 find / -type f -print0 | xargs -0 du -h | sort -rh | head -n 10 \u6e05\u7a7a\u4e00\u4e2a\u5927\u6587\u4ef6 mkdir empty && rsync -r --delete empty/ some-dir && rmdir some-dir tips : \u5f53\u4e00\u4e2a\u6587\u4ef6\u5f88\u5927\u7684\u662f\uff0c\u540c\u65f6\u786c\u76d8\u4e2d\u6ca1\u6709\u5176\u4ed6\u8d44\u6e90\uff0c\u90a3\u4e48\u683c\u5f0f\u5316\u662f\u6700\u5feb\u7684\u65b9\u5f0f \u5217\u51fa\u786c\u76d8 lsblk #\u5217\u51fa\u5757\u8bbe\u5907\u4fe1\u606f\uff08df -h\u4e0d\u80fd\u770b\u5230\u7684\u5377\uff09 \u67e5\u770b\u6587\u4ef6 \u67e5\u770b\u76ee\u5f55\u603b\u5927\u5c0f du -sh \u67e5\u770b\u76ee\u5f55\u4e0b\u5404\u4e2a\u6587\u4ef6/\u76ee\u5f55\u5927\u5c0f ls -lh \u663e\u793a\u76f4\u63a5\u5b50\u76ee\u5f55\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\u5927\u5c0f\u7edf\u8ba1\u503c du -h \u2013max-depth=0 * \u8d44\u6e90\u6587\u6863 the-art-of-command-line(\u65b0\u624b)","title":"\u5e38\u7528\u811a\u672c"},{"location":"script/#_1","text":"\u5f53\u6211\u4eec\u5728\u8fd0\u884c\u673a\u5668\u7684\u65f6\u5019\uff0c\u5e73\u65f6\u53ef\u80fd\u8981\u5904\u7406\u4e00\u4e9b\u57fa\u672c\u7684\u903b\u8f91\u3002\u5bf9\u4e8e\u8fd9\u5feb\u53ef\u80fd\u5c31\u5c5e\u4e8e\u4e00\u4e2a\u4f53\u529b\u6d3b\u4e86\uff0c\u4e0d\u8fc7\u5982\u679c\u80fd\u628a\u4e00\u4e9b\u5e38\u7528\u547d\u4ee4\u8fdb\u884c\u5f52\u6863\uff0c\u90a3\u4e48\u4e0b\u6b21\u4f7f\u7528\u7684\u662f\u5c31\u53ef\u4ee5\u76f4\u63a5\u62ff\u6765\u7528\u3002\u5982\u679c\u8fd9\u4e9b\u547d\u4ee4\u90fd\u662f\u5efa\u7acb\u5728linux \u547d\u4ee4\u7684\u57fa\u7840\u4e0a\uff0c\u6240\u4ee5\u5982\u679c\u5bf9\u8fd9\u5feb\u4e0d\u662f\u5f88\u719f\u6089\u7684\uff0c\u63a8\u8350\u7ffb\u9605 linuxcool \u8fdb\u884c\u5904\u7406.","title":"\u5e38\u7528\u8fd0\u7ef4\u547d\u4ee4"},{"location":"script/#_2","text":"\u67e5\u770b\u7cfb\u7edf\u5f53\u524d\u7f51\u7edc\u8fde\u63a5\u6570 netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' \u6309\u7167 CPU/\u5185\u5b58\u7684\u4f7f\u7528\u60c5\u51b5\u5217\u51fa\u524d 10 \u7684\u8fdb\u7a0b #\u5185\u5b58 ps axo %mem,pid,euser,cmd | sort -nr | head -10 #CPU ps -aeo pcpu,user,pid,cmd | sort -nr | head -10 \u663e\u793a\u7cfb\u7edf\u6574\u4f53\u7684 CPU \u5229\u7528\u7387\u548c\u95f2\u7f6e\u7387 grep \"cpu \" /proc/stat | awk -F ' ' '{total = $2 + $3 + $4 + $5} END {print \"idle \\t used\\n\" $5*100/total \"% \" $2*100/total \"%\"}' \u5feb\u901f\u6740\u6b7b\u6240\u6709\u7684 xx \u8fdb\u7a0b ps aux | grep xx | awk '{ print $2 }' | xargs kill -9 \u67e5\u627e/\u76ee\u5f55\u4e0b\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u6700\u5927\u7684top10\u6587\u4ef6 find / -type f -print0 | xargs -0 du -h | sort -rh | head -n 10 \u6e05\u7a7a\u4e00\u4e2a\u5927\u6587\u4ef6 mkdir empty && rsync -r --delete empty/ some-dir && rmdir some-dir tips : \u5f53\u4e00\u4e2a\u6587\u4ef6\u5f88\u5927\u7684\u662f\uff0c\u540c\u65f6\u786c\u76d8\u4e2d\u6ca1\u6709\u5176\u4ed6\u8d44\u6e90\uff0c\u90a3\u4e48\u683c\u5f0f\u5316\u662f\u6700\u5feb\u7684\u65b9\u5f0f \u5217\u51fa\u786c\u76d8 lsblk #\u5217\u51fa\u5757\u8bbe\u5907\u4fe1\u606f\uff08df -h\u4e0d\u80fd\u770b\u5230\u7684\u5377\uff09","title":"\u5e38\u7528\u547d\u4ee4"},{"location":"script/#_3","text":"\u67e5\u770b\u76ee\u5f55\u603b\u5927\u5c0f du -sh \u67e5\u770b\u76ee\u5f55\u4e0b\u5404\u4e2a\u6587\u4ef6/\u76ee\u5f55\u5927\u5c0f ls -lh \u663e\u793a\u76f4\u63a5\u5b50\u76ee\u5f55\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\u5927\u5c0f\u7edf\u8ba1\u503c du -h \u2013max-depth=0 *","title":"\u67e5\u770b\u6587\u4ef6"},{"location":"script/#_4","text":"the-art-of-command-line(\u65b0\u624b)","title":"\u8d44\u6e90\u6587\u6863"},{"location":"script/docker/","text":"docker \u5e38\u7528\u547d\u4ee4 \u5173\u95ed 1\u3001\u5173\u95ed\u4ee5--restart=always\u542f\u52a8\u7684\u5bb9\u5668 docker update --restart=no <container-id> docker stop <container-id> \u5220\u9664 1\u3001\u67e5\u8be2\u5e76\u5220\u9664\u6240\u6709\u5bb9\u5668 docker stop $( docker ps -q ) & docker rm $( docker ps -aq ) # sudo \u6743\u9650 sudo docker stop $( sudo docker ps -q ) & sudo docker rm $( sudo docker ps -aq ) 2\u3001\u67e5\u8be2\u5e76\u5220\u9664\u6240\u6709images # docker rmi `docker images -q` # docker rmi $(docker images -q) # docker rmi $(docker images -q) -f 3\u3001\u5220\u9664\u6240\u6709\u5df2\u505c\u6b62\u7684\u5bb9\u5668 docker rm $(docker ps -a -q) 4\u3001\u5220\u9664\u610f\u89c1\u9000\u51fa\u7684\u5bb9\u5668 docker rm $(docker ps -q -f status=exited) 5\u3001\u6b63\u5219\u5220\u9664 sudo docker ps -a | grep \u5305\u542b\u540d\u5b57 | awk '{print $1}' | xargs sudo docker rm -f \u6bd4\u5982\u5220\u9664\u5305\u542b registrator sudo docker ps -a | grep registrator | awk '{print $1}' | xargs sudo docker rm -f \u8bbe\u7f6e \u66f4\u6539\u5b58\u50a8\u8def\u5f84\u548c\u6e90 \u4e0b\u9762\u662f\u786c\u76d8\u6302\u8f7d\u4e86 /opt \u76ee\u5f55\u4e0b\uff0c\u6240\u4ee5\u8bbe\u7f6e\u628a\u6570\u636e\u5b58\u50a8\u5728 /opt/docker \uff0c /etc/docker/daemon.json { \"registry-mirrors\" : [ \"http://ovfftd6p.mirror.aliyuncs.com\" , \"http://registry.docker-cn.com\" , \"http://docker.mirrors.ustc.edu.cn\" , \"http://hub-mirror.c.163.com\" ] , \"insecure-registries\" : [ \"registry.docker-cn.com\" , \"docker.mirrors.ustc.edu.cn\" ] , \"graph\" : \"/opt/docker\" , \"debug\" : true, \"experimental\" : true } \u53ef\u4f7f\u7528\u8d44\u6e90 docker command","title":"docker"},{"location":"script/docker/#docker","text":"","title":"docker \u5e38\u7528\u547d\u4ee4"},{"location":"script/docker/#_1","text":"","title":"\u5173\u95ed"},{"location":"script/docker/#1-restartalways","text":"docker update --restart=no <container-id> docker stop <container-id>","title":"1\u3001\u5173\u95ed\u4ee5--restart=always\u542f\u52a8\u7684\u5bb9\u5668"},{"location":"script/docker/#_2","text":"","title":"\u5220\u9664"},{"location":"script/docker/#1","text":"docker stop $( docker ps -q ) & docker rm $( docker ps -aq ) # sudo \u6743\u9650 sudo docker stop $( sudo docker ps -q ) & sudo docker rm $( sudo docker ps -aq )","title":"1\u3001\u67e5\u8be2\u5e76\u5220\u9664\u6240\u6709\u5bb9\u5668"},{"location":"script/docker/#2images","text":"# docker rmi `docker images -q` # docker rmi $(docker images -q) # docker rmi $(docker images -q) -f","title":"2\u3001\u67e5\u8be2\u5e76\u5220\u9664\u6240\u6709images"},{"location":"script/docker/#3","text":"docker rm $(docker ps -a -q)","title":"3\u3001\u5220\u9664\u6240\u6709\u5df2\u505c\u6b62\u7684\u5bb9\u5668"},{"location":"script/docker/#4","text":"docker rm $(docker ps -q -f status=exited)","title":"4\u3001\u5220\u9664\u610f\u89c1\u9000\u51fa\u7684\u5bb9\u5668"},{"location":"script/docker/#5","text":"sudo docker ps -a | grep \u5305\u542b\u540d\u5b57 | awk '{print $1}' | xargs sudo docker rm -f \u6bd4\u5982\u5220\u9664\u5305\u542b registrator sudo docker ps -a | grep registrator | awk '{print $1}' | xargs sudo docker rm -f","title":"5\u3001\u6b63\u5219\u5220\u9664"},{"location":"script/docker/#_3","text":"","title":"\u8bbe\u7f6e"},{"location":"script/docker/#_4","text":"\u4e0b\u9762\u662f\u786c\u76d8\u6302\u8f7d\u4e86 /opt \u76ee\u5f55\u4e0b\uff0c\u6240\u4ee5\u8bbe\u7f6e\u628a\u6570\u636e\u5b58\u50a8\u5728 /opt/docker \uff0c /etc/docker/daemon.json { \"registry-mirrors\" : [ \"http://ovfftd6p.mirror.aliyuncs.com\" , \"http://registry.docker-cn.com\" , \"http://docker.mirrors.ustc.edu.cn\" , \"http://hub-mirror.c.163.com\" ] , \"insecure-registries\" : [ \"registry.docker-cn.com\" , \"docker.mirrors.ustc.edu.cn\" ] , \"graph\" : \"/opt/docker\" , \"debug\" : true, \"experimental\" : true }","title":"\u66f4\u6539\u5b58\u50a8\u8def\u5f84\u548c\u6e90"},{"location":"script/docker/#_5","text":"docker command","title":"\u53ef\u4f7f\u7528\u8d44\u6e90"},{"location":"script/python/","text":"Python python \u5728\u5904\u7406\u4e00\u4e9b\u95ee\u9898\u7684\u65f6\u5019\u4e5f\u662f\u6bd4shell \u66f4\u52a0\u65b9\u4fbf \u6279\u91cf\u751f\u4ea7IP\u6bb5 ansible hosts \u586b\u5165\u4e00\u6279\u673a\u5668 for i in range(115, 145): print(\"192.168.4.{}\".format(i))","title":"python"},{"location":"script/python/#python","text":"python \u5728\u5904\u7406\u4e00\u4e9b\u95ee\u9898\u7684\u65f6\u5019\u4e5f\u662f\u6bd4shell \u66f4\u52a0\u65b9\u4fbf","title":"Python"},{"location":"script/python/#ip","text":"ansible hosts \u586b\u5165\u4e00\u6279\u673a\u5668 for i in range(115, 145): print(\"192.168.4.{}\".format(i))","title":"\u6279\u91cf\u751f\u4ea7IP\u6bb5"}]}